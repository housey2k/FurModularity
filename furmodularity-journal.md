<!--
  This journal is auto generated by Hack Club Blueprint.
-->

## 12/26/2025 4 PM - Designed power circuit  

_Time spent: 2.0h_  

The foundation of every circuit is it's power, so my first step to designing a board is designing the power circuit
I started adding connectors for USB-C charging, and LiPo battery
I added a MCP73871 (Load Sharing and Battery Charge Controller) to handle USB and LiPo power, and two TPS63030, these ICs generate the 3.3V and 5V rails that will be used to power the microcontroller and peripherals with 3.3V, and 5V to power the LCD backlight and audio circuit!
![Power circuit](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAxMzIsInB1ciI6ImJsb2JfaWQifX0=--245f2cdaf2bf59daa9b37373b1d4c851df93419e/Captura%20de%20tela%202025-12-26%20165424.png)
  

## 12/26/2025 6 PM - Partial MCU  

_Time spent: 1.4h_  

I picked a ESP32-S3 for this project due to its high processing power and easy to implement board with built in antenna and decoupling circuits.
I already added button input and LCD output, I'll be adding audio control lines once the audio circuit is finshed
![MCU](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAxODEsInB1ciI6ImJsb2JfaWQifX0=--4092a8d59620448ccb5556a32275edbf6d874386/image.png)
  

## 12/26/2025 9 PM - Finished designing audio circuit  

_Time spent: 2.7h_  

I finished designing the audio circuit
For volume, I picked the MCP4261 because it's a popular digital potentiometer IC that's well documented and has libraries for it.
I used the 74VHC4066N Quad Analog Switch for routing inputs to outputs, it's a modern and simple IC.
I'm using the LMV324 because it's similiar to the popular LM324, but suitable for low voltage rail-to-rail operation.
Now we have a basic mixer inside the device, with two inputs and two outputs, you can route inputs A, B or both to outputs A, B, or both, and you can also tweak inputs A and B volume
This is how the audio circuit turned out:
![Audio circuit](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzMDUsInB1ciI6ImJsb2JfaWQifX0=--572be086398f1409b9f60ce5173bdba0eda8a015/image.png)
This is how the MCU turned circuit turned out:
![MCU](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzMDYsInB1ciI6ImJsb2JfaWQifX0=--0ccaa48f9bc64d05b25c13b2d4e8b249ba2dc207/image.png)
  

## 12/26/2025 10 PM - Added module headers, finished MCU design  

_Time spent: 0.3h_  

Added connectors for the modules, the original design was supposed to have 4 modules, but I switched to 5 because there was A LOT of free GPIO
![Header schematics](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzNDEsInB1ciI6ImJsb2JfaWQifX0=--c122be32cef68fadd84a8d085838d219864634f6/image.png)
This is how the finished MCU looks like
![MCU](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzNDIsInB1ciI6ImJsb2JfaWQifX0=--8f6a9a8236b65c5dca24770c9c83a8944b71697f/image.png)
  

## 12/27/2025 12 AM - Finished PCB layout + schematic changes  

_Time spent: 1.5h_  

I just finished the PCB layout, this is how it looks so far:
![PCB](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzNjYsInB1ciI6ImJsb2JfaWQifX0=--02d3e904202fe46f273d8819e6f6181b064c4d67/image.png)
A few changes were made to the circuit:
![Power](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzNjcsInB1ciI6ImJsb2JfaWQifX0=--d9d48ee28b27a7b5ebc1b143e8874e288bd90973/image.png)
On the power circuit, I added a VBAT sense voltage divider so the microcontroller can know the battery voltage level, and a charge sense through the MCP's PG# pin
This is how the MCU looks like with the added lines:
![MCU](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzAzNjgsInB1ciI6ImJsb2JfaWQifX0=--fc46e7659db8f56f9c63f77e7a8155bc1fa8a68e/image.png)
  

## 12/27/2025 12 PM - Changed reference voltage for summing amplifiers  

_Time spent: 0.5h_  

Today I learned that when working with a single rail summing amplifier circuit, we cannot put GND on the non inverting input like we see on many schematics on the internet. We should actually reference it to 1/2VCC (That's 0V if it was a dual rail circuit). So I did a small change of putting a voltage divider on the 3.3V line and replacing GND with a line called `REF_1V65` on all the op-amps, below you can see the voltage divider I created:
![Divider](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA2MTEsInB1ciI6ImJsb2JfaWQifX0=--47e4e82836f7333123293a4bf798cd525f91d1ff/image.png)
And here is how it looks on the amplifiers:
![amps](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA2MTIsInB1ciI6ImJsb2JfaWQifX0=--b77fe8ab019efe5400d9764e063c36dfa575ba1c/image.png)
  

## 12/27/2025 2 PM - Changed PCB layout due to RF concerns  

_Time spent: 2.8h_  

On the previous board the ESP32 was around the middle of the board, but I learned that the antenna should be positioned in the board edge for better signal quality, less noise in the circuit and less power used.
Since there was a lot of free space I also changed the position of the buck/boost converters and made them more spaced for thermal and noise concerns. This involved rerouting parts of these sectors
This is how the board looks now midway through routing:
![Board](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA3MTMsInB1ciI6ImJsb2JfaWQifX0=--f308a4c6e35c6789a984bfb61efafb948de5ca02/image.png)
  

## 12/27/2025 3 PM - Connected buttons to GPIO  

_Time spent: 0.2h_  

There's not much to talk here, it's just that I forgot to connect the button lines to the ESP32.
I realized it while I was routing the board and saw that there are no ratlines. It was a pretty quick fix
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA3MjgsInB1ciI6ImJsb2JfaWQifX0=--a4ae63daa5d6341a59ed397bcd1bdde878966697/image.png)
  

## 12/27/2025 6 PM - Finished PCB  

_Time spent: 3.0h_  

After A LOT of suffering and layout changes, I received some feedback and I decided to switch to a 4 layer PCB with a ground and a 3.3V plane, that made the board way cleaner since now there are solid power and ground planes that are way less likely to have noise or voltage drop issues.
I also switched the inductors L1 and L2 to a L1207 packaging, that made them way smaller, this is how the actual final PCB looks like:
![PCB](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA4NDMsInB1ciI6ImJsb2JfaWQifX0=--f9e3249e3963ad29285d7f14694efdd3a8d58a37/image.png)
  

## 12/27/2025 7 PM - USB pins change  

_Time spent: 0.3h_  

I just learned that the USB pins are one of the few things that are NOT handled by the ESP32's internal IOMUX, they are fixed to GPIOs 19 and 20, so I had to switch D- to GPIO19, D+ to GPIO20, and CTRL_IN2_OUT1 to IO21, This is how the MCU side looks now:
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA4OTUsInB1ciI6ImJsb2JfaWQifX0=--d030e68bc8b877585652ad5b4d70293ebaecfd29/image.png)
And this is how the MCU looks on the PCB:
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzA4OTcsInB1ciI6ImJsb2JfaWQifX0=--ebb98e1dc95b89eb31b6d39d93134ab9cbe1138e/image.png)

  

## 12/27/2025 11 PM - Started writing firmware  

_Time spent: 3.0h_  

Started writing the WIP firmware, I already have a hopefully working sketch that performs the power-on-self-test (it interacts with the digital potentiometer's to confirm they are connected and working, at least I think that is really fancy), and then writes the main menu, and allows you to move an arrow around that later when you click enter it will go into a sub-menu.
The complete firmware is avaiable at the GitHub repository
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzEwMDIsInB1ciI6ImJsb2JfaWQifX0=--3dc5bd0afbbdb7a83aece776f5ccc6a1b75c1da7/image.png)
  

## 12/28/2025 12 PM - Started rerouting PCB... Againüòµ‚Äçüí´  

_Time spent: 1.0h_  

I did my PCB without noticing that it was slightly wider than 100mm, that generates a big engineering fee. I tried partially rerouting by copying and pasting the old traces, the only part I touched was the MCU and module connectors, but stuff kept breaking on the whole board so I'm just doing it again
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzEzNjcsInB1ciI6ImJsb2JfaWQifX0=--6893706c323dc6db059e4052d39332795454dfe6/image.png)
  

## 12/28/2025 2 PM - Finished PCB  

_Time spent: 2.8h_  

After a lot of work the board is finally ready, this time with no fees, now instead it costs $7.00, the earlier board had a $30+ engineering fee because of a few milimiters too big. This is how the board turned out:
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzE0NzAsInB1ciI6ImJsb2JfaWQifX0=--7217c9488ccf2987043247488b70472919e840e5/image.png)
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzE0NzEsInB1ciI6ImJsb2JfaWQifX0=--5ca82a36d149332fd6b8dc860d087249f2388469/image.png)
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzE0NzIsInB1ciI6ImJsb2JfaWQifX0=--7f1dfa42007fc38bd4aec25a50ac987e1061fa24/image.png)
  

## 12/28/2025 4 PM - Updated GitHub  

_Time spent: 1.0h_  

I just published the updated BOM, gerbers and schematics to the GitHub repository, I also received a lot of cool feedback from a different engineering community, while that made me change the PCB a bunch of times, hopefully it will work flawlessly after assembly
![image](https://blueprint.hackclub.com/user-attachments/blobs/proxy/eyJfcmFpbHMiOnsiZGF0YSI6MzE1NTUsInB1ciI6ImJsb2JfaWQifX0=--16f0ead779f61c4641b99cfd0708069e62415309/image.png)
  

